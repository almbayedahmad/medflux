name: Tag Version Parity

on:
  push:
    tags:
      - 'v*'

jobs:
  check-version:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - name: Verify tag matches core/versioning/VERSION
        shell: bash
        run: |
          TAG="${GITHUB_REF_NAME}"
          FILEV=$(cat core/versioning/VERSION | tr -d '\n')
          if [[ "v${FILEV}" != "$TAG" ]]; then
            echo "Tag $TAG does not match VERSION $FILEV" >&2
            exit 1
          fi
          echo "OK: $TAG matches VERSION $FILEV"
