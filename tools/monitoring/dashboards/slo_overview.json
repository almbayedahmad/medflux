{
  "title": "MedFlux - SLO Overview",
  "uid": "medflux-slo",
  "schemaVersion": 39,
  "panels": [
    {
      "type": "text",
      "title": "Onboarding",
      "gridPos": {"x": 0, "y": 0, "w": 24, "h": 4},
      "options": {
        "mode": "markdown",
        "content": "- Burn rate normalized to 2% error budget (adjust in alerts).\\n- Panels filter to job=\"medflux\".\\n- Enable OTEL + Tempo to surface trace exemplars on histograms."
      }
    },
    {
      "type": "stat",
      "title": "Validation Success (5m)",
      "gridPos": {"x": 0, "y": 4, "w": 6, "h": 4},
      "targets": [
        {"expr": "sum(rate(medflux_validation_ok_total{job=\"medflux\"}[5m])) / (sum(rate(medflux_validation_ok_total{job=\"medflux\"}[5m])) + sum(rate(medflux_validation_failed_total{job=\"medflux\"}[5m])))", "legendFormat": "success"}
      ],
      "options": {"reduceOptions": {"calcs": ["lastNotNull"]}, "orientation": "horizontal"},
      "fieldConfig": {"defaults": {"unit": "percentunit"}}
    },
    {
      "type": "stat",
      "title": "Validation Success (1h)",
      "gridPos": {"x": 6, "y": 4, "w": 6, "h": 4},
      "targets": [
        {"expr": "sum(rate(medflux_validation_ok_total{job=\"medflux\"}[1h])) / (sum(rate(medflux_validation_ok_total{job=\"medflux\"}[1h])) + sum(rate(medflux_validation_failed_total{job=\"medflux\"}[1h])))", "legendFormat": "success_1h"}
      ],
      "options": {"reduceOptions": {"calcs": ["lastNotNull"]}},
      "fieldConfig": {"defaults": {"unit": "percentunit"}}
    },
    {
      "type": "gauge",
      "title": "Burn Rate (5m / 2% budget)",
      "gridPos": {"x": 12, "y": 4, "w": 6, "h": 4},
      "targets": [
        {"expr": "(sum(rate(medflux_validation_failed_total{job=\"medflux\"}[5m])) / (sum(rate(medflux_validation_failed_total{job=\"medflux\"}[5m])) + sum(rate(medflux_validation_ok_total{job=\"medflux\"}[5m])))) / 0.02", "legendFormat": "burn_5m"}
      ],
      "fieldConfig": {"defaults": {"min": 0, "max": 10}}
    },
    {
      "type": "gauge",
      "title": "Burn Rate (1h / 2% budget)",
      "gridPos": {"x": 18, "y": 4, "w": 6, "h": 4},
      "targets": [
        {"expr": "(sum(rate(medflux_validation_failed_total{job=\"medflux\"}[1h])) / (sum(rate(medflux_validation_failed_total{job=\"medflux\"}[1h])) + sum(rate(medflux_validation_ok_total{job=\"medflux\"}[1h])))) / 0.02", "legendFormat": "burn_1h"}
      ],
      "fieldConfig": {"defaults": {"min": 0, "max": 10}}
    },
    {
      "type": "timeseries",
      "title": "Success Ratio by Phase (5m)",
      "gridPos": {"x": 0, "y": 8, "w": 24, "h": 8},
      "targets": [
        {"expr": "sum(rate(medflux_validation_ok_total{job=\"medflux\"}[5m])) by (phase) / (sum(rate(medflux_validation_ok_total{job=\"medflux\"}[5m])) by (phase) + sum(rate(medflux_validation_failed_total{job=\"medflux\"}[5m])) by (phase))", "legendFormat": "{{phase}}"}
      ],
      "fieldConfig": {"defaults": {"unit": "percentunit"}}
    },
    {
      "type": "timeseries",
      "title": "Validation p95 Latency (ms)",
      "gridPos": {"x": 0, "y": 16, "w": 24, "h": 8},
      "targets": [
        {"expr": "histogram_quantile(0.95, sum(rate(medflux_validation_duration_ms_bucket{job=\"medflux\"}[10m])) by (le, phase))", "legendFormat": "{{phase}}"}
      ]
    }
  ],
  "refresh": "30s",`n  "templating": {"list": []},
  "time": {"from": "now-6h", "to": "now"}
}
